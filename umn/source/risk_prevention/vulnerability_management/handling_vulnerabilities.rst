:original_name: hss_01_0141.html

.. _hss_01_0141:

Handling Vulnerabilities
========================

If HSS detects a vulnerability on a server, you need to handle the vulnerability in a timely manner based on its severity and your business conditions to prevent the vulnerability from being exploited by intruders.

Vulnerabilities can be handled in the following ways:

-  **Fixing vulnerabilities**

   If a vulnerability may harm your services, fix it as soon as possible. For Linux and Windows vulnerabilities, you can let HSS fix them in one-click. Web-CMS vulnerabilities and application vulnerabilities cannot be automatically fixed. Handle them by referring to the suggestions provided on the vulnerability details page.

-  **Ignoring vulnerabilities**

   Some vulnerabilities are risky only in specific conditions. For example, if a vulnerability can be exploited only through an open port, but the target server does not open any ports, the vulnerability will not harm the server. If you can confirm that a vulnerability is harmless, you can ignore it. If the vulnerability is detected again in the next vulnerability scan, HSS will still report it.

Constraints
-----------

-  CentOS 6 and CentOS 8 are officially End of Life (EOL) and no longer maintained. HSS scans them for vulnerabilities based on Red Hat patch notices but cannot fix them. You are advised to change to other OSs.
-  Ubuntu 18.04 and earlier versions do not support free patch updates. You need to apply and configure Ubuntu Pro to install upgrade packages, or vulnerability fix will fail.
-  The kernel vulnerabilities on CCE, MRS, and BMS servers cannot be fixed. Fixing them may make some functions unavailable.
-  To handle vulnerabilities on a server, ensure the server is in the **Running** state, its agent status is **Online**, and its protection status is **Protected**.

Precautions
-----------

-  Vulnerability fixing operations cannot be rolled back. If a vulnerability fails to be fixed, services will probably be interrupted, and incompatibility issues will probably occur in middleware or upper layer applications. To prevent unexpected consequences, you are advised to use CBR to back up ECSs. Then, use idle servers to simulate the production environment and test-fix the vulnerability. If the test-fix succeeds, fix the vulnerability on servers running in the production environment.
-  Servers need to access the Internet and use external image sources to fix vulnerabilities.

Urgency
-------

-  **High**: This vulnerability must be fixed as soon as possible. Attackers may exploit this vulnerability to damage the server.
-  **Medium**: You are advised to fix the vulnerability to enhance your server security.
-  **Safe for now**: This vulnerability has a small threat to server security. You can choose to fix or ignore it.

Vulnerability Fix Priority
--------------------------

HSS' vulnerability scan system classifies vulnerability fix priorities into four levels: critical, high, medium, and low. You can refer to the priorities to fix the vulnerabilities that have significant impact on your server first.

-  **Critical**: This vulnerability must be fixed immediately. Attackers may exploit this vulnerability to cause great damage to the server.
-  **High**: This vulnerability must be fixed as soon as possible. Attackers may exploit this vulnerability to damage the server.
-  **Medium**: You are advised to fix the vulnerability to enhance your server security.
-  **Low**: This vulnerability has a small threat to server security. You can choose to fix or ignore it.

Vulnerability Display
---------------------

Detected vulnerabilities will be displayed in the vulnerability list for seven days, regardless of whether you have handled them.

Automatically Fixing Vulnerabilities (Vulnerability View)
---------------------------------------------------------

You can only fix Linux and Windows vulnerabilities with one-click on the console.

.. note::

   A maximum of 1,000 server vulnerabilities can be fixed at a time. If there are more than 1,000 vulnerabilities, fix them in batches.

#. Log in to the management console.
#. In the navigation pane, choose **Prediction** > **Vulnerabilities**.
#. Fix Linux and Windows vulnerabilities.

   -  Fixing a single vulnerability

      Locate the row containing a target vulnerability and click **Fix** in the **Operation** column.

   -  Fixing multiple vulnerabilities

      Select all target vulnerabilities and click **Fix** in the upper left corner of the vulnerability list to fix vulnerabilities in batches.

      To fix all Linux or Windows vulnerabilities, select **Select all Linux vulnerabilities** or **Select all Windows vulnerabilities** in the **Fix** dialog box.

   -  Fix one or more servers affected by a vulnerability.

      a. Click a vulnerability name.

      b. On the vulnerability details slide-out panel displayed, click the **Affected** tab, locate the row containing the target server, and click **Fix** in the **Operation** column.

         You can also select all target servers and click **Fix** above the server list to fix vulnerabilities for the servers in batches.

4. In the **Fix** dialog box displayed, select **I am aware that if I have not backed up my ECSs before fixing vulnerabilities, services may be interrupted and fail to be rolled back during maintenance.** and click **Auto Fix**.

5. Click a vulnerability name.

6. Click the **Handling History** tab to view the fix status of the target vulnerability in the **Status** column. :ref:`Table 1 <hss_01_0141__table1309111182315>` describes vulnerability fix statuses.

   .. _hss_01_0141__table1309111182315:

   .. table:: **Table 1** Vulnerability fix statuses

      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Status                            | Description                                                                                                                                                                                                                 |
      +===================================+=============================================================================================================================================================================================================================+
      | Unhandled                         | The vulnerability is not fixed.                                                                                                                                                                                             |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Ignored                           | The vulnerability does not affect your services. You have ignored the vulnerability.                                                                                                                                        |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Verifying                         | HSS is verifying whether a fixed vulnerability is successfully fixed.                                                                                                                                                       |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Fixing                            | HSS is fixing the vulnerability.                                                                                                                                                                                            |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Fixed                             | The vulnerability has been successfully fixed.                                                                                                                                                                              |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Restart required                  | The vulnerability has been successfully fixed. You need to restart the server as soon as possible.                                                                                                                          |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Failed                            | The vulnerability fails to be fixed. The possible cause is that the vulnerability does not exist or has been changed.                                                                                                       |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Restart the server and try again  | This status is displayed only for vulnerabilities that exist on Windows servers.                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                             |
      |                                   | The vulnerability has not been fixed on the Windows server for a long time. As a result, the latest patch cannot be installed. You need to install an earlier patch, restart the server, and then install the latest patch. |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Automatically Fixing Vulnerabilities (Server View)
--------------------------------------------------

You can only fix Linux and Windows vulnerabilities with one-click on the console.

#. Log in to the management console.

#. In the navigation pane, choose **Prediction** > **Vulnerabilities**.

#. Fix Linux and Windows vulnerabilities.

   -  Fixing all vulnerabilities on a server

      a. Locate the row containing a target server and click **Fix** in the **Operation** column.

         You can also select multiple servers and click **Fix** in the upper part of the vulnerability list. To fix all server vulnerabilities, you can select all servers in the batch fix dialog box.

      b. In the **Fix** dialog box displayed, select the type of the vulnerability to be fixed, select **I am aware that if I have not backed up my ECSs before fixing vulnerabilities, services may be interrupted and fail to be rolled back during maintenance.**, and click **OK**.

         Only Linux and Windows vulnerabilities can be automatically fixed with one-click. Web-CMS and application vulnerabilities need to be manually fixed by logging in to the server.

      c. Click the server name. On the server details slide-out panel displayed, view the vulnerability fix status. :ref:`Table 2 <hss_01_0141__table1148064981617>` describes vulnerability fix statuses.

   -  Fixing one or more vulnerabilities on a server

      a. Click the name of a target server. The server details slide-out panel is displayed.

      b. Locate the row containing a target vulnerability and click **Fix** in the **Operation** column.

         Alternatively, you can select all target vulnerabilities and click **Fix** above the vulnerability list to fix vulnerabilities in batches.

      c. In the **Fix** dialog box displayed, select **I am aware that if I have not backed up my ECSs before fixing vulnerabilities, services may be interrupted and fail to be rolled back during maintenance.**, and click **Auto Fix**.

      d. In the **Status** column of the target vulnerability, view the fix status of the vulnerability. :ref:`Table 2 <hss_01_0141__table1148064981617>` describes vulnerability fix statuses.

   .. _hss_01_0141__table1148064981617:

   .. table:: **Table 2** Vulnerability fix statuses

      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Status                            | Description                                                                                                                                                                                                                 |
      +===================================+=============================================================================================================================================================================================================================+
      | Unhandled                         | The vulnerability is not fixed.                                                                                                                                                                                             |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Ignored                           | The vulnerability does not affect your services. You have ignored the vulnerability.                                                                                                                                        |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Verifying                         | HSS is verifying whether a fixed vulnerability is successfully fixed.                                                                                                                                                       |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Fixing                            | HSS is fixing the vulnerability.                                                                                                                                                                                            |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Fixed                             | The vulnerability has been successfully fixed.                                                                                                                                                                              |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Restart required                  | The vulnerability has been successfully fixed. You need to restart the server as soon as possible.                                                                                                                          |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Failed                            | The vulnerability fails to be fixed. The possible cause is that the vulnerability does not exist or has been changed.                                                                                                       |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Restart the server and try again  | This status is displayed only for vulnerabilities that exist on Windows servers.                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                             |
      |                                   | The vulnerability has not been fixed on the Windows server for a long time. As a result, the latest patch cannot be installed. You need to install an earlier patch, restart the server, and then install the latest patch. |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Ignoring a Vulnerability
------------------------

Some vulnerabilities are risky only in specific conditions. For example, if a vulnerability can be exploited only through an open port, but the target server does not open any ports, the vulnerability will not harm the server. Such vulnerabilities can be ignored.

After the vulnerability is ignored, no alarm will be generated for the vulnerability.

#. Log in to the management console.
#. In the navigation pane, choose **Prediction** > **Vulnerabilities**.
#. Locate the row containing a target vulnerability and click **Ignore** in the **Operation** column.
#. In the dialog box displayed, click **OK**.

Whitelisting Vulnerabilities
----------------------------

If you evaluate that some vulnerabilities do not affect your services and do not want to view the vulnerabilities in the vulnerability list, you can whitelist the vulnerabilities. After they are whitelisted, the vulnerabilities will be ignored in the vulnerability list and no alarms will be reported. The vulnerabilities will not be scanned and the vulnerability information will not be displayed when the next vulnerability scan task is executed.

#. Log in to the management console.
#. In the navigation pane, choose **Prediction** > **Vulnerabilities**.

   -  Whitelisting all servers that are affected by a vulnerability

      HSS will ignore the vulnerability when scanning for vulnerabilities on all servers.

      a. In the **Operation** column of the row containing the target vulnerability, click **More** and select **Add to Whitelist**.

         You can also select multiple vulnerabilities and click **Add to Whitelist** above the vulnerability list.


         .. figure:: /_static/images/en-us_image_0000001853976253.png
            :alt: **Figure 1** Whitelisting all servers that are affected by a vulnerability

            **Figure 1** Whitelisting all servers that are affected by a vulnerability

      b. In the dialog box displayed, click **OK**.

   -  Whitelisting one or more servers that are affected by a vulnerability

      HSS will ignore the vulnerability when scanning for vulnerabilities on these servers.

      a. Click a target vulnerability name.

      b. On the slide-out panel displayed, click the **Affected** tab.

      c. In the **Operation** column of the row containing the target server, click **More** and select **Add to Whitelist**.

         You can also select multiple servers and click **Add to Whitelist** above the server list.


         .. figure:: /_static/images/en-us_image_0000001853897085.png
            :alt: **Figure 2** Whitelisting a single server that is affected by a vulnerability

            **Figure 2** Whitelisting a single server that is affected by a vulnerability

      d. In the dialog box displayed, click **OK**.

   -  Whitelisting vulnerabilities using whitelist rules

      a. In the upper right corner of the **Vulnerabilities** page, click **Configure Policy**. The **Configure Policy** slide-out panel is displayed.

      b. In the **Vulnerability Whitelist** area, click **Add Rule**.

      c. Configure a whitelist rule according to :ref:`Table 3 <hss_01_0141__table15714142382020>`.


         .. figure:: /_static/images/en-us_image_0000001807098924.png
            :alt: **Figure 3** Configuring a whitelist rule

            **Figure 3** Configuring a whitelist rule

         .. _hss_01_0141__table15714142382020:

         .. table:: **Table 3** Vulnerability whitelist rule parameters

            +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------+
            | Parameter                         | Description                                                                                                                   |
            +===================================+===============================================================================================================================+
            | Type                              | Select the type of vulnerabilities to be whitelisted. Possible values are as follows:                                         |
            |                                   |                                                                                                                               |
            |                                   | -  **Linux Vulnerabilities**                                                                                                  |
            |                                   | -  **Windows Vulnerabilities**                                                                                                |
            |                                   | -  **Web-CMS Vulnerabilities**                                                                                                |
            |                                   | -  **Application Vulnerabilities**                                                                                            |
            +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------+
            | Vulnerability                     | Select one or more vulnerabilities to be whitelisted.                                                                         |
            +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------+
            | Rule Scope                        | Select the servers affected by the vulnerabilities. Possible values are as follows:                                           |
            |                                   |                                                                                                                               |
            |                                   | -  **All servers**                                                                                                            |
            |                                   |                                                                                                                               |
            |                                   |    HSS will ignore the vulnerability when scanning for vulnerabilities on all servers.                                        |
            |                                   |                                                                                                                               |
            |                                   | -  **Selected servers**                                                                                                       |
            |                                   |                                                                                                                               |
            |                                   |    Select one or more target servers. HSS will ignore the vulnerabilities when scanning for vulnerabilities on these servers. |
            |                                   |                                                                                                                               |
            |                                   |    You can search for a target server by server name, ID, EIP, or private IP address.                                         |
            +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------+
            | Remarks (Optional)                | Enter the remarks.                                                                                                            |
            +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------+

      d. Click **OK**.

Verifying the Vulnerability Fix
-------------------------------

After you manually fix vulnerabilities, you are advised to verify the fixing result.

-  **Method 1**: On the vulnerability details page, click **Verify** to perform one-click verification.

   .. note::

      -  The fixing of emergency vulnerabilities cannot be verified.
      -  Only application vulnerabilities of the JAR package can be verified. Application vulnerabilities of the non-JAR package are automatically filtered out and not verified.

-  **Method 2**: Ensure the software has been upgraded to the latest version. The following table provides the commands to check the software upgrade result.

   .. table:: **Table 4** Verification commands

      ================================== ===============================
      OS                                 Verification Command
      ================================== ===============================
      CentOS/Fedora /Euler/Redhat/Oracle rpm -qa \| grep *Software_name*
      Debian/Ubuntu                      dpkg -l \| grep *Software_name*
      Gentoo                             emerge --search *Software_name*
      ================================== ===============================
