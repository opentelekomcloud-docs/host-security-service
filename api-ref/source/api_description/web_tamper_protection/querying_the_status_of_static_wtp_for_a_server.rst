:original_name: ListHostProtectHistoryInfo.html

.. _ListHostProtectHistoryInfo:

Querying the Status of Static WTP for a Server
==============================================

Function
--------

This API is used to query the status of static WTP for a server.

URI
---

GET /v5/{project_id}/webtamper/static/protect-history

.. table:: **Table 1** Path Parameters

   +-----------------+-----------------+-----------------+-----------------+
   | Parameter       | Mandatory       | Type            | Description     |
   +=================+=================+=================+=================+
   | project_id      | Yes             | String          | Project ID      |
   |                 |                 |                 |                 |
   |                 |                 |                 | Minimum: **0**  |
   |                 |                 |                 |                 |
   |                 |                 |                 | Maximum: **64** |
   +-----------------+-----------------+-----------------+-----------------+

.. table:: **Table 2** Query Parameters

   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory       | Type            | Description                                                                                                                                                   |
   +=======================+=================+=================+===============================================================================================================================================================+
   | enterprise_project_id | No              | String          | Enterprise project ID. The value **0** indicates the default enterprise project. To query all enterprise projects, set this parameter to **all_granted_eps**. |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Default: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **64**                                                                                                                                               |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | host_id               | No              | String          | Host ID. If this parameter is left empty, all the servers are queried.                                                                                        |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **128**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | start_time            | Yes             | Long            | Start time (ms)                                                                                                                                               |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **4070880000000**                                                                                                                                    |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | end_time              | Yes             | Long            | End time (ms)                                                                                                                                                 |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **4070880000000**                                                                                                                                    |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit                 | Yes             | Integer         | Number of records displayed on each page.                                                                                                                     |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **100**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | offset                | Yes             | Integer         | Offset, which specifies the start position of the record to be returned.                                                                                      |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **100**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +-----------------+-----------------+-----------------+--------------------+
   | Parameter       | Mandatory       | Type            | Description        |
   +=================+=================+=================+====================+
   | X-Auth-Token    | Yes             | String          | User token.        |
   |                 |                 |                 |                    |
   |                 |                 |                 | Minimum: **1**     |
   |                 |                 |                 |                    |
   |                 |                 |                 | Maximum: **32768** |
   +-----------------+-----------------+-----------------+--------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------------------+------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+
   | Parameter             | Type                                                                                                                         | Description                          |
   +=======================+==============================================================================================================================+======================================+
   | host_name             | String                                                                                                                       | Server name                          |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | Minimum: **0**                       |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | Maximum: **256**                     |
   +-----------------------+------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+
   | protect_status        | String                                                                                                                       | Protection status. Its value can be: |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | -  close                             |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | -  opened                            |
   +-----------------------+------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+
   | total_num             | Long                                                                                                                         | total number of static WTPs          |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | Minimum: **0**                       |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | Maximum: **20000000**                |
   +-----------------------+------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+
   | data_list             | Array of :ref:`HostProtectHistoryResponseInfo <listhostprotecthistoryinfo__response_hostprotecthistoryresponseinfo>` objects | data list                            |
   |                       |                                                                                                                              |                                      |
   |                       |                                                                                                                              | Array Length: **0 - 20000**          |
   +-----------------------+------------------------------------------------------------------------------------------------------------------------------+--------------------------------------+

.. _listhostprotecthistoryinfo__response_hostprotecthistoryresponseinfo:

.. table:: **Table 5** HostProtectHistoryResponseInfo

   +-----------------------+-----------------------+------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                            |
   +=======================+=======================+========================================================================+
   | occr_time             | Long                  | Static WTP detection time (ms)                                         |
   |                       |                       |                                                                        |
   |                       |                       | Minimum: **0**                                                         |
   |                       |                       |                                                                        |
   |                       |                       | Maximum: **4070880000000**                                             |
   +-----------------------+-----------------------+------------------------------------------------------------------------+
   | file_path             | String                | Tampered file path                                                     |
   |                       |                       |                                                                        |
   |                       |                       | Minimum: **0**                                                         |
   |                       |                       |                                                                        |
   |                       |                       | Maximum: **2000**                                                      |
   +-----------------------+-----------------------+------------------------------------------------------------------------+
   | process_id            | String                | Process ID. This parameter is returned if the OS is Windows.           |
   |                       |                       |                                                                        |
   |                       |                       | Minimum: **0**                                                         |
   |                       |                       |                                                                        |
   |                       |                       | Maximum: **8**                                                         |
   +-----------------------+-----------------------+------------------------------------------------------------------------+
   | process_name          | String                | Process name. This parameter is returned if the OS is Windows.         |
   |                       |                       |                                                                        |
   |                       |                       | Minimum: **0**                                                         |
   |                       |                       |                                                                        |
   |                       |                       | Maximum: **200**                                                       |
   +-----------------------+-----------------------+------------------------------------------------------------------------+
   | process_cmd           | String                | Process command line. This parameter is returned if the OS is Windows. |
   |                       |                       |                                                                        |
   |                       |                       | Minimum: **0**                                                         |
   |                       |                       |                                                                        |
   |                       |                       | Maximum: **8191**                                                      |
   +-----------------------+-----------------------+------------------------------------------------------------------------+

Example Requests
----------------

Query the static WTP status of a server where target ID is caa958ad-a481-4d46-b51e-6861b8864515, start time is 1668563099000, and end time is 1668563199000.

.. code-block:: text

   GET https://{endpoint}/v5/{project_id}/webtamper/static/protect-history

   {
     "host_id" : "caa958ad-a481-4d46-b51e-6861b8864515",
     "start_time" : 1668563099000,
     "end_time" : 1668563199000,
     "limit" : 10,
     "offset" : 0
   }

Example Responses
-----------------

**Status code: 200**

successful response

.. code-block::

   {
     "host_name" : "ecs-ubuntu",
     "protect_status" : "opened",
     "total_num" : 1,
     "data_list" : [ {
       "occr_time" : 1668156691000,
       "file_path" : "/root/test/tamper/test.xml",
       "process_id" : "18672",
       "process_name" : "program1",
       "process_cmd" : "del test.xml"
     } ]
   }

Status Codes
------------

=========== ===================
Status Code Description
=========== ===================
200         successful response
=========== ===================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
