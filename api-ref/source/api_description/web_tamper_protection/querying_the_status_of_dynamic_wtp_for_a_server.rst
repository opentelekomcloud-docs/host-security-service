:original_name: ListHostRaspProtectHistoryInfo.html

.. _ListHostRaspProtectHistoryInfo:

Querying the Status of Dynamic WTP for a Server
===============================================

Function
--------

This API is used to query the status of dynamic WTP for a server.

URI
---

GET /v5/{project_id}/webtamper/rasp/protect-history

.. table:: **Table 1** Path Parameters

   +-----------------+-----------------+-----------------+-----------------+
   | Parameter       | Mandatory       | Type            | Description     |
   +=================+=================+=================+=================+
   | project_id      | Yes             | String          | Project ID      |
   |                 |                 |                 |                 |
   |                 |                 |                 | Minimum: **0**  |
   |                 |                 |                 |                 |
   |                 |                 |                 | Maximum: **64** |
   +-----------------+-----------------+-----------------+-----------------+

.. table:: **Table 2** Query Parameters

   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory       | Type            | Description                                                                                                                                                   |
   +=======================+=================+=================+===============================================================================================================================================================+
   | enterprise_project_id | No              | String          | Enterprise project ID. The value **0** indicates the default enterprise project. To query all enterprise projects, set this parameter to **all_granted_eps**. |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Default: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **64**                                                                                                                                               |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | host_id               | No              | String          | Host ID. If this parameter is left empty, all the servers are queried.                                                                                        |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **128**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | start_time            | Yes             | Long            | Start time (ms)                                                                                                                                               |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **4070880000000**                                                                                                                                    |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | end_time              | Yes             | Long            | End time (ms)                                                                                                                                                 |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **4070880000000**                                                                                                                                    |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit                 | Yes             | Integer         | Number of records displayed on each page.                                                                                                                     |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **100**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | offset                | Yes             | Integer         | Offset, which specifies the start position of the record to be returned.                                                                                      |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **100**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | alarm_level           | No              | Integer         | Alarm severity. The options are as follows:                                                                                                                   |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  1: low-risk                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  2: medium risk                                                                                                                                             |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  3: high risk                                                                                                                                               |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  4: major                                                                                                                                                   |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **100**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | severity              | No              | String          | Threat level. Its value can be:                                                                                                                               |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  Security                                                                                                                                                   |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  Low: low risk                                                                                                                                              |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  Medium: medium risk                                                                                                                                        |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  High: high risk                                                                                                                                            |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  Critical                                                                                                                                                   |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **32**                                                                                                                                               |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | protect_status        | No              | String          | Protection status.                                                                                                                                            |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  closed: disabled                                                                                                                                           |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  opened: protection enabled                                                                                                                                 |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **32**                                                                                                                                               |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +-----------------+-----------------+-----------------+--------------------+
   | Parameter       | Mandatory       | Type            | Description        |
   +=================+=================+=================+====================+
   | X-Auth-Token    | Yes             | String          | User token.        |
   |                 |                 |                 |                    |
   |                 |                 |                 | Minimum: **1**     |
   |                 |                 |                 |                    |
   |                 |                 |                 | Maximum: **32768** |
   +-----------------+-----------------+-----------------+--------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------------------+------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+
   | Parameter             | Type                                                                                                                                     | Description                  |
   +=======================+==========================================================================================================================================+==============================+
   | total_num             | Long                                                                                                                                     | total number of dynamic WTPs |
   |                       |                                                                                                                                          |                              |
   |                       |                                                                                                                                          | Minimum: **0**               |
   |                       |                                                                                                                                          |                              |
   |                       |                                                                                                                                          | Maximum: **200000**          |
   +-----------------------+------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+
   | data_list             | Array of :ref:`HostRaspProtectHistoryResponseInfo <listhostraspprotecthistoryinfo__response_hostraspprotecthistoryresponseinfo>` objects | data list                    |
   |                       |                                                                                                                                          |                              |
   |                       |                                                                                                                                          | Array Length: **0 - 200000** |
   +-----------------------+------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+

.. _listhostraspprotecthistoryinfo__response_hostraspprotecthistoryresponseinfo:

.. table:: **Table 5** HostRaspProtectHistoryResponseInfo

   +-----------------------+-----------------------+-------------------------------------------+
   | Parameter             | Type                  | Description                               |
   +=======================+=======================+===========================================+
   | alarm_time            | Long                  | Alarm time of dynamic WTP (ms)            |
   |                       |                       |                                           |
   |                       |                       | Minimum: **0**                            |
   |                       |                       |                                           |
   |                       |                       | Maximum: **4070880000000**                |
   +-----------------------+-----------------------+-------------------------------------------+
   | threat_type           | String                | Threat type                               |
   |                       |                       |                                           |
   |                       |                       | Minimum: **0**                            |
   |                       |                       |                                           |
   |                       |                       | Maximum: **64**                           |
   +-----------------------+-----------------------+-------------------------------------------+
   | alarm_level           | Integer               | Alarm severity                            |
   |                       |                       |                                           |
   |                       |                       | Minimum: **0**                            |
   |                       |                       |                                           |
   |                       |                       | Maximum: **100**                          |
   +-----------------------+-----------------------+-------------------------------------------+
   | source_ip             | String                | Source IP address of the attacking server |
   |                       |                       |                                           |
   |                       |                       | Minimum: **0**                            |
   |                       |                       |                                           |
   |                       |                       | Maximum: **128**                          |
   +-----------------------+-----------------------+-------------------------------------------+
   | attacked_url          | String                | URL of the attack request                 |
   |                       |                       |                                           |
   |                       |                       | Minimum: **0**                            |
   |                       |                       |                                           |
   |                       |                       | Maximum: **2000**                         |
   +-----------------------+-----------------------+-------------------------------------------+

Example Requests
----------------

Query the dynamic WTP status of a server where target ID is caa958ad-a481-4d46-b51e-6861b8864515, start time is 1668563099000, and end time is 1668563199000.

.. code-block:: text

   GET https://{endpoint}/v5/{project_id}/webtamper/rasp/protect-history

   {
     "host_id" : "caa958ad-a481-4d46-b51e-6861b8864515",
     "start_time" : 1668563099000,
     "end_time" : 1668563199000,
     "limit" : 10,
     "offset" : 0
   }

Example Responses
-----------------

**Status code: 200**

successful response

.. code-block::

   {
     "total_num" : 1,
     "data_list" : [ {
       "alarm_level" : 2,
       "alarm_time" : 1668394634000,
       "attacked_url" : "/vulns/001-dir-1.jsp",
       "source_ip" : "10.100.30.200",
       "threat_type" : "Path Traversal"
     } ]
   }

Status Codes
------------

=========== ===================
Status Code Description
=========== ===================
200         successful response
=========== ===================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
