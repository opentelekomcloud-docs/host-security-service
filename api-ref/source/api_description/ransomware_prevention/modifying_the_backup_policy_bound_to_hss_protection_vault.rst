:original_name: UpdateBackupPolicyInfo.html

.. _UpdateBackupPolicyInfo:

Modifying the Backup Policy Bound to HSS Protection Vault
=========================================================

Function
--------

This API is used to modify the backup policy associated with the vault

URI
---

PUT /v5/{project_id}/backup/policy

.. table:: **Table 1** Path Parameters

   +-----------------+-----------------+-----------------+------------------+
   | Parameter       | Mandatory       | Type            | Description      |
   +=================+=================+=================+==================+
   | project_id      | Yes             | String          | Project ID       |
   |                 |                 |                 |                  |
   |                 |                 |                 | Minimum: **1**   |
   |                 |                 |                 |                  |
   |                 |                 |                 | Maximum: **256** |
   +-----------------+-----------------+-----------------+------------------+

.. table:: **Table 2** Query Parameters

   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory       | Type            | Description                                                                                                                                                   |
   +=======================+=================+=================+===============================================================================================================================================================+
   | enterprise_project_id | No              | String          | Enterprise project ID. The value **0** indicates the default enterprise project. To query all enterprise projects, set this parameter to **all_granted_eps**. |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Default: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **1**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **256**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +-----------------+-----------------+-----------------+--------------------+
   | Parameter       | Mandatory       | Type            | Description        |
   +=================+=================+=================+====================+
   | X-Auth-Token    | Yes             | String          | User token.        |
   |                 |                 |                 |                    |
   |                 |                 |                 | Minimum: **1**     |
   |                 |                 |                 |                    |
   |                 |                 |                 | Maximum: **32768** |
   +-----------------+-----------------+-----------------+--------------------+

.. table:: **Table 4** Request body parameters

   +----------------------+-----------------+---------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------+
   | Parameter            | Mandatory       | Type                                                                                                          | Description                                               |
   +======================+=================+===============================================================================================================+===========================================================+
   | enabled              | No              | Boolean                                                                                                       | Whether the policy is enabled. The default value is true. |
   +----------------------+-----------------+---------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------+
   | policy_id            | Yes             | String                                                                                                        | Backup policy ID                                          |
   |                      |                 |                                                                                                               |                                                           |
   |                      |                 |                                                                                                               | Minimum: **1**                                            |
   |                      |                 |                                                                                                               |                                                           |
   |                      |                 |                                                                                                               | Maximum: **256**                                          |
   +----------------------+-----------------+---------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------+
   | operation_definition | No              | :ref:`OperationDefinitionRequestInfo <updatebackuppolicyinfo__request_operationdefinitionrequestinfo>` object | Scheduling parameter.                                     |
   +----------------------+-----------------+---------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------+
   | trigger              | No              | :ref:`BackupTriggerRequestInfo <updatebackuppolicyinfo__request_backuptriggerrequestinfo>` object             | Time scheduling rule for the policy                       |
   +----------------------+-----------------+---------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------+

.. _updatebackuppolicyinfo__request_operationdefinitionrequestinfo:

.. table:: **Table 5** OperationDefinitionRequestInfo

   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter               | Mandatory       | Type            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   +=========================+=================+=================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | day_backups             | No              | Integer         | Maximum number of retained daily backups. The latest backup of each day is saved in the long term. This parameter is not affected by the maximum number of retained backup. The value ranges from 0 to 100. If this parameter is specified, timezone must be configured. Minimum value: 0. Maximum value: 100                                                                                                                               |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | max_backups             | No              | Integer         | Maximum number of automated backups that can be retained for an object. The value can be -1 or ranges from 0 to 99999. If the value is set to -1, the backups will not be cleared even though the configured retained backup quantity limit is exceeded. If this parameter and retention_duration_days are left blank at the same time, the backups will be retained permanently. Minimum value: 1. Maximum value: 99999. Default value: -1 |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **-1**                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **99999**                                                                                                                                                                                                                                                                                                                                                                                                                          |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | month_backups           | No              | Integer         | Maximum number of retained monthly backups. The latest backup of each month is saved in the long term. This parameter is not affected by the maximum number of retained backup. The value ranges from 0 to 100. If this parameter is specified, timezone must be configured. Minimum value: 0. Maximum value: 100                                                                                                                           |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | retention_duration_days | No              | Integer         | Duration of retaining a backup, in days. The maximum value is 99999. If the value is set to -1, backups will not be cleared even though the configured retention duration is exceeded. If this parameter and max_backups are left blank at the same time, the backups will be retained permanently. Minimum value: 1. Maximum value: 99999. Default value: -1                                                                               |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **-1**                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **99999**                                                                                                                                                                                                                                                                                                                                                                                                                          |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | timezone                | No              | String          | Time zone where the user is located, for example, UTC+08:00. Set this parameter only after you have configured any of the parameters day_backups, week_backups, month_backups, and year_backups.                                                                                                                                                                                                                                            |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **256**                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | week_backups            | No              | Integer         | Maximum number of retained weekly backups. The latest backup of each week is saved in the long term. This parameter can be effective together with the maximum number of retained backups specified by max_backups. The value ranges from 0 to 100. If this parameter is specified, timezone must be configured.                                                                                                                            |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | year_backups            | No              | Integer         | Maximum number of retained yearly backups. The latest backup of each year is saved in the long term. This parameter can be effective together with the maximum number of retained backups specified by max_backups. The value ranges from 0 to 100. If this parameter is specified, timezone must be configured. Minimum value: 0. Maximum value: 100                                                                                       |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Minimum: **0**                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                         |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                         |                 |                 | Maximum: **100**                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +-------------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _updatebackuppolicyinfo__request_backuptriggerrequestinfo:

.. table:: **Table 6** BackupTriggerRequestInfo

   +------------+-----------+-----------------------------------------------------------------------------------------------------------------------+-------------------------------------+
   | Parameter  | Mandatory | Type                                                                                                                  | Description                         |
   +============+===========+=======================================================================================================================+=====================================+
   | properties | Yes       | :ref:`BackupTriggerPropertiesRequestInfo <updatebackuppolicyinfo__request_backuptriggerpropertiesrequestinfo>` object | Time rule for the policy execution. |
   +------------+-----------+-----------------------------------------------------------------------------------------------------------------------+-------------------------------------+

.. _updatebackuppolicyinfo__request_backuptriggerpropertiesrequestinfo:

.. table:: **Table 7** BackupTriggerPropertiesRequestInfo

   +-----------------+-----------------+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   +=================+=================+==================+============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | pattern         | Yes             | Array of strings | Scheduling rule A maximum of 24 rules can be configured. The scheduling rule complies with iCalendar RFC 2445, but it supports only parameters FREQ, BYDAY, BYHOUR, BYMINUTE, and INTERVAL. FREQ can be set only to WEEKLY or DAILY. BYDAY can be set to MO, TU, WE, TH, FR, SA, or SU (seven days of a week). BYHOUR ranges from 0 to 23 hours. BYMINUTE ranges from 0 minutes to 59 minutes. The scheduling interval must not be less than 1 hour. A maximum of 24 time points are allowed in a day. For example, if the scheduling time is 14:00 from Monday to Sunday, set the scheduling rule as follows: FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00. To start scheduling at 14:00 every day, the rule is as follows: FREQ=DAILY;INTERVAL=1;BYHOUR=14;BYMINUTE=00'. |
   |                 |                 |                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                 |                 |                  | Minimum: **1**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                 |                 |                  | Maximum: **256**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
   |                 |                 |                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                 |                 |                  | Array Length: **0 - 24**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   +-----------------+-----------------+------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

None

Example Requests
----------------

Modify the backup policy. The target backup policy ID is af4d08ad-2b60-4916-a5cf-8d6a23956dda.

.. code-block:: text

   PUT https://{endpoint}/v5/{project_id}/backup/policy

   {
     "enabled" : true,
     "policy_id" : "af4d08ad-2b60-4916-a5cf-8d6a23956dda",
     "operation_definition" : {
       "day_backups" : 0,
       "max_backups" : -1,
       "month_backups" : 0,
       "retention_duration_days" : 5,
       "timezone" : "UTC+08:00",
       "week_backups" : 0,
       "year_backups" : 0
     },
     "trigger" : {
       "properties" : {
         "pattern" : [ "FREQ=DAILY;INTERVAL=2;BYHOUR=14;BYMINUTE=00" ]
       }
     }
   }

Example Responses
-----------------

None

Status Codes
------------

=========== =======================
Status Code Description
=========== =======================
200         Modify a backup policy.
=========== =======================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
