:original_name: ListProtectionPolicy.html

.. _ListProtectionPolicy:

Querying the Protection Policy List of Ransomware
=================================================

Function
--------

This API is used to query the protection policy list of ransomware.

URI
---

GET /v5/{project_id}/ransomware/protection/policy

.. table:: **Table 1** Path Parameters

   +-----------------+-----------------+-----------------+------------------+
   | Parameter       | Mandatory       | Type            | Description      |
   +=================+=================+=================+==================+
   | project_id      | Yes             | String          | Project ID       |
   |                 |                 |                 |                  |
   |                 |                 |                 | Minimum: **1**   |
   |                 |                 |                 |                  |
   |                 |                 |                 | Maximum: **256** |
   +-----------------+-----------------+-----------------+------------------+

.. table:: **Table 2** Query Parameters

   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory       | Type            | Description                                                                                                                                                   |
   +=======================+=================+=================+===============================================================================================================================================================+
   | enterprise_project_id | No              | String          | Enterprise project ID. The value **0** indicates the default enterprise project. To query all enterprise projects, set this parameter to **all_granted_eps**. |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Default: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **1**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **256**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | offset                | No              | Integer         | Offset, which specifies the start position of the record to be returned.                                                                                      |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **2000000**                                                                                                                                          |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Default: **0**                                                                                                                                                |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | limit                 | No              | Integer         | Number of records displayed on each page.                                                                                                                     |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **10**                                                                                                                                               |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **200**                                                                                                                                              |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Default: **10**                                                                                                                                               |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | policy_name           | No              | String          | Policy name                                                                                                                                                   |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Minimum: **0**                                                                                                                                                |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | Maximum: **128**                                                                                                                                              |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | operating_system      | No              | String          | OSs supported by the policy. The options are as follows:                                                                                                      |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  Windows                                                                                                                                                    |
   |                       |                 |                 |                                                                                                                                                               |
   |                       |                 |                 | -  Linux                                                                                                                                                      |
   +-----------------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +-----------------+-----------------+-----------------+--------------------+
   | Parameter       | Mandatory       | Type            | Description        |
   +=================+=================+=================+====================+
   | X-Auth-Token    | Yes             | String          | User token.        |
   |                 |                 |                 |                    |
   |                 |                 |                 | Minimum: **1**     |
   |                 |                 |                 |                    |
   |                 |                 |                 | Maximum: **32768** |
   +-----------------+-----------------+-----------------+--------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 4** Response body parameters

   +-----------------------+----------------------------------------------------------------------------------------------------+-----------------------------+
   | Parameter             | Type                                                                                               | Description                 |
   +=======================+====================================================================================================+=============================+
   | total_num             | Integer                                                                                            | Total number of policies    |
   |                       |                                                                                                    |                             |
   |                       |                                                                                                    | Minimum: **0**              |
   |                       |                                                                                                    |                             |
   |                       |                                                                                                    | Maximum: **2097152**        |
   +-----------------------+----------------------------------------------------------------------------------------------------+-----------------------------+
   | data_list             | Array of :ref:`ProtectionPolicyInfo <listprotectionpolicy__response_protectionpolicyinfo>` objects | Query the list of policies. |
   |                       |                                                                                                    |                             |
   |                       |                                                                                                    | Array Length: **0 - 10241** |
   +-----------------------+----------------------------------------------------------------------------------------------------+-----------------------------+

.. _listprotectionpolicy__response_protectionpolicyinfo:

.. table:: **Table 5** ProtectionPolicyInfo

   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Parameter                   | Type                  | Description                                                                                                                |
   +=============================+=======================+============================================================================================================================+
   | policy_id                   | String                | Policy ID                                                                                                                  |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **0**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **128**                                                                                                           |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | policy_name                 | String                | Policy name                                                                                                                |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **0**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **128**                                                                                                           |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | protection_mode             | String                | Action. Its value can be:                                                                                                  |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  alarm_and_isolation: Report an alarm and isolate.                                                                       |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  alarm_only: Only report alarms.                                                                                         |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | bait_protection_status      | String                | Whether to enable honeypot protection. By default, the protection is enabled. Its value can be:                            |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  opened                                                                                                                  |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  closed                                                                                                                  |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | protection_directory        | String                | Protected directory                                                                                                        |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **1**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **128**                                                                                                           |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | protection_type             | String                | Protected file type, for example, .docx, .txt, and .avi.                                                                   |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **0**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **128**                                                                                                           |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | exclude_directory           | String                | (Optional) excluded directory                                                                                              |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **1**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **128**                                                                                                           |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | runtime_detection_status    | String                | Whether to perform runtime checks. The options are as follows. Currently, it can only be disabled. This field is reserved. |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  opened                                                                                                                  |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  closed                                                                                                                  |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | runtime_detection_directory | String                | Directory to be checked during running. This field is reserved.                                                            |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **1**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **128**                                                                                                           |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | count_associated_server     | Integer               | Number of associated servers                                                                                               |
   |                             |                       |                                                                                                                            |
   |                             |                       | Minimum: **0**                                                                                                             |
   |                             |                       |                                                                                                                            |
   |                             |                       | Maximum: **2097152**                                                                                                       |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | operating_system            | String                | OS type. Its value can be:                                                                                                 |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  Linux                                                                                                                   |
   |                             |                       |                                                                                                                            |
   |                             |                       | -  Windows                                                                                                                 |
   +-----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+

Example Requests
----------------

Query the protection policy list of ransomware. If limit is not specified, 10 records are returned by default.

.. code-block:: text

   GET https://{endpoint}/v5/{project_id}/ransomware/protection/policy

Example Responses
-----------------

**Status code: 200**

Linux protection policy list

.. code-block::

   {
     "total_num" : 1,
     "data_list" : [ {
       "bait_protection_status" : "opened",
       "exclude_directory" : "/opt",
       "count_associated_server" : 0,
       "operating_system" : "Linux",
       "protection_mode" : "alarm_only",
       "policy_id" : "4117d16-074b-41ae-b7d7-9cc25ee258",
       "policy_name" : "test",
       "protection_directory" : "/dd",
       "protection_type" : "docx",
       "runtime_detection_status" : "closed"
     } ]
   }

Status Codes
------------

=========== ============================
Status Code Description
=========== ============================
200         Linux protection policy list
=========== ============================

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
